
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-a1ce949a.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-bccf8c07.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-c5541673.js"></script>
  </head>

  <body class="index" data-languages="[&quot;raw&quot;,&quot;swift&quot;,&quot;java&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-9c311519.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="raw">raw</a>
              <a href="#" data-language-name="swift">swift</a>
              <a href="#" data-language-name="java">java</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#getting-started" class="toc-h1 toc-link" data-title="Getting Started">Getting Started</a>
          </li>
          <li>
            <a href="#initialization" class="toc-h1 toc-link" data-title="Initialization">Initialization</a>
          </li>
          <li>
            <a href="#starting-the-sdk" class="toc-h1 toc-link" data-title="Starting the SDK">Starting the SDK</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#begin" class="toc-h2 toc-link" data-title="Begin">Begin</a>
                  </li>
                  <li>
                    <a href="#appinstance-active" class="toc-h2 toc-link" data-title="AppInstance Active">AppInstance Active</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#events-and-actions" class="toc-h1 toc-link" data-title="Events and Actions">Events and Actions</a>
          </li>
          <li>
            <a href="#api-extension-for-custom-endpoints" class="toc-h1 toc-link" data-title="Api Extension for custom endpoints">Api Extension for custom endpoints</a>
          </li>
          <li>
            <a href="#platform-requests" class="toc-h1 toc-link" data-title="Platform Requests">Platform Requests</a>
          </li>
          <li>
            <a href="#spark-compass-rest-api" class="toc-h1 toc-link" data-title="Spark Compass REST Api">Spark Compass REST Api</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#headers" class="toc-h2 toc-link" data-title="Headers">Headers</a>
                  </li>
                  <li>
                    <a href="#register-app-instance" class="toc-h2 toc-link" data-title="Register App Instance">Register App Instance</a>
                  </li>
                  <li>
                    <a href="#update-appinstance" class="toc-h2 toc-link" data-title="Update AppInstance">Update AppInstance</a>
                  </li>
                  <li>
                    <a href="#end-user-registration" class="toc-h2 toc-link" data-title="End User Registration.">End User Registration.</a>
                  </li>
                  <li>
                    <a href="#end-user-login" class="toc-h2 toc-link" data-title="End User Login">End User Login</a>
                  </li>
                  <li>
                    <a href="#test-end-user-access-token" class="toc-h2 toc-link" data-title="Test end user access token">Test end user access token</a>
                  </li>
                  <li>
                    <a href="#end-user-logout" class="toc-h2 toc-link" data-title="End User Logout">End User Logout</a>
                  </li>
                  <li>
                    <a href="#get-end-user-profile" class="toc-h2 toc-link" data-title="Get End User Profile">Get End User Profile</a>
                  </li>
                  <li>
                    <a href="#update-end-user-profile" class="toc-h2 toc-link" data-title="Update End User Profile">Update End User Profile</a>
                  </li>
                  <li>
                    <a href="#update-end-user-profile-image" class="toc-h2 toc-link" data-title="Update End User Profile Image">Update End User Profile Image</a>
                  </li>
                  <li>
                    <a href="#forgot-password-request" class="toc-h2 toc-link" data-title="Forgot password request">Forgot password request</a>
                  </li>
                  <li>
                    <a href="#change-password" class="toc-h2 toc-link" data-title="Change Password">Change Password</a>
                  </li>
                  <li>
                    <a href="#change-email" class="toc-h2 toc-link" data-title="Change Email">Change Email</a>
                  </li>
                  <li>
                    <a href="#app-uid-for-code" class="toc-h2 toc-link" data-title="App UID for code">App UID for code</a>
                  </li>
                  <li>
                    <a href="#get-a-menu-by-name" class="toc-h2 toc-link" data-title="GET a menu by name">GET a menu by name</a>
                  </li>
                  <li>
                    <a href="#menu-item" class="toc-h2 toc-link" data-title="Menu Item">Menu Item</a>
                  </li>
                  <li>
                    <a href="#page-templates" class="toc-h2 toc-link" data-title="Page Templates">Page Templates</a>
                  </li>
                  <li>
                    <a href="#action" class="toc-h2 toc-link" data-title="Action">Action</a>
                  </li>
                  <li>
                    <a href="#actions" class="toc-h2 toc-link" data-title="Actions:">Actions:</a>
                  </li>
                  <li>
                    <a href="#posting-events" class="toc-h2 toc-link" data-title="Posting Events">Posting Events</a>
                  </li>
                  <li>
                    <a href="#get-geolocations" class="toc-h2 toc-link" data-title="Get Geolocations">Get Geolocations</a>
                  </li>
                  <li>
                    <a href="#geolocation" class="toc-h2 toc-link" data-title="Geolocation">Geolocation</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#fitness-module-api" class="toc-h1 toc-link" data-title="Fitness module API">Fitness module API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-workouts" class="toc-h2 toc-link" data-title="Get Workouts">Get Workouts</a>
                  </li>
                  <li>
                    <a href="#get-exercises" class="toc-h2 toc-link" data-title="Get Exercises">Get Exercises</a>
                  </li>
                  <li>
                    <a href="#get-zones" class="toc-h2 toc-link" data-title="Get Zones">Get Zones</a>
                  </li>
                  <li>
                    <a href="#get-goals" class="toc-h2 toc-link" data-title="Get Goals">Get Goals</a>
                  </li>
                  <li>
                    <a href="#get-levels" class="toc-h2 toc-link" data-title="Get Levels">Get Levels</a>
                  </li>
                  <li>
                    <a href="#get-devices" class="toc-h2 toc-link" data-title="Get Devices">Get Devices</a>
                  </li>
                  <li>
                    <a href="#get-equipment" class="toc-h2 toc-link" data-title="Get Equipment">Get Equipment</a>
                  </li>
                  <li>
                    <a href="#get-activities" class="toc-h2 toc-link" data-title="Get Activities">Get Activities</a>
                  </li>
                  <li>
                    <a href="#submit-activity" class="toc-h2 toc-link" data-title="Submit Activity">Submit Activity</a>
                  </li>
                  <li>
                    <a href="#get-videos" class="toc-h2 toc-link" data-title="Get Videos">Get Videos</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='getting-started'>Getting Started</h1>
<p>Start a new IOS Xcode project and at the root of the project create a folder called frameworks to keep Frameworks that we will add in.</p>

<p>Add the following frameworks to this folder and add them in the Link Binaries With Libraries section of the project. You will need to request these from TCS/SparkCompass</p>

<ul>
<li>TCSAPI.framework</li>
<li>Gimbal.framework (Only required for bluetooth beacons)</li>
</ul>

<p>Import the TCSAPI SDK</p>
<pre class="highlight swift tab-swift"><code><span class="c1">//Add to the swit bridging header eg. in Project-Bridging-Header.h</span>
<span class="cp">#import &lt;TCSAPI/TCSAPI.h&gt;</span>

</code></pre>
<p>The following background modes and data protection are required:</p>

<ul>
<li>Uses Bluetooth LE Accessories</li>
<li>Remote Notifications</li>
<li>Data Protection</li>
</ul>
<h1 id='initialization'>Initialization</h1>
<blockquote>
<p>To initialise, use this code:</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">class</span> <span class="kt">AppDelegate</span><span class="p">:</span> <span class="kt">UIResponder</span><span class="p">,</span> <span class="kt">UIApplicationDelegate</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">NSObject</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="kt">TCSAppInstance</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="n">appUID</span> <span class="o">=</span> <span class="s">"&lt;appuid&gt;"</span>

        <span class="k">let</span> <span class="nv">instance</span><span class="p">:</span><span class="kt">TCSAPIConnector</span> <span class="o">=</span> <span class="kt">TCSAPIConnector</span><span class="o">.</span><span class="nf">instance</span><span class="p">()</span> <span class="k">as!</span> <span class="kt">TCSAPIConnector</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">appUrl</span> <span class="o">=</span> <span class="s">"https://&lt;domain.sparkcompass.com&gt;"</span> <span class="c1">// You will be provided a domain</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">baseUrl</span> <span class="o">=</span> <span class="s">"https://&lt;domain.sparkcompass.com&gt;"</span> <span class="c1">// You will be provided a domain</span>

        <span class="c1">//SDK requires local notifications to deliver certain messaging types.</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">_</span> <span class="o">=</span> <span class="n">launchOptions</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">localnotif</span><span class="p">:</span><span class="kt">UILocalNotification</span><span class="p">?</span> <span class="o">=</span> <span class="n">launchOptions</span><span class="p">?[</span><span class="kt">UIApplicationLaunchOptionsLocalNotificationKey</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">UILocalNotification</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">localnotif</span> <span class="o">!=</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">TCSAppInstance</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="nf">receivedLocalNotification</span><span class="p">(</span><span class="n">localnotif</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="o">...</span>
    <span class="p">}</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code>
</code></pre><pre class="highlight javascript tab-javascript"><code>
</code></pre>
<blockquote>
<p>Make sure to replace <code>&lt;appuid&gt;</code> with the appUid we supply you.</p>
</blockquote>

<p>SparkCompass uses an appUid to allow access to the API. You will be supplied with your AppUid when we set up your account. You will also be supplied with a subdomain to connect to.</p>

<p>Supply the AppUid and Subdomain as shown in the code examples to initialise the SDK.</p>

<p>The following section describes how to connect to the platform.</p>

<aside class="notice">
You must replace <code>`appuid`</code> with the appUid we supply you.
</aside>
<h1 id='starting-the-sdk'>Starting the SDK</h1><h2 id='begin'>Begin</h2>
<p>After the app starts and the above initialization is completed, the SDK has to be started to initialize the connection with the platform.</p>

<p>This should occur anytime the app is started from a not running state. Ie does not have to be called everytime the App wakes from the background.</p>

<p>This connects to the platform and identifies this device as having access. </p>
<pre class="highlight swift tab-swift"><code><span class="c1">//An example placed in AppDelegate</span>
<span class="c1">//Typically this may go elsewhere after confirmation of EULA</span>

 <span class="kd">func</span> <span class="nf">applicationDidBecomeActive</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//If the appInstance is not active then attempt to activate it.</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="kt">TCSAppInstance</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="nf">isAppActive</span><span class="p">()){</span>
        <span class="kt">TCSAppInstance</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="n">beginWithCompletion</span> <span class="p">{</span> <span class="p">(</span><span class="nv">success</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">,</span> <span class="nv">reply</span><span class="p">:</span> <span class="kt">String</span><span class="o">!</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Can now make other API calls to the platform</span>
                <span class="c1">// TCSAppInstance.sharedInstance().isAppActive() returns true</span>
                <span class="c1">// The SDK will also send a "APPINSTANCE_ACTIVE" NSNotification when ready</span>


                <span class="kt">TCSAppInstance</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="nf">updateRegisteredTokenApp</span><span class="p">()</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">reply</span> <span class="o">==</span> <span class="s">"EULANOTACCEPTED"</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="nf">promptToAcceptEULA</span><span class="p">()</span> <span class="c1">// Eula must be accepted prior to begin</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">reply</span> <span class="o">==</span> <span class="s">"APPLICATION_ERROR"</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// Some problem with the AppUID.</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><h2 id='appinstance-active'>AppInstance Active</h2>
<blockquote>
<p>You can check whether the AppInstance has begun correctly and is ready to make API calls to the platform using the following:</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kt">TCSAppInstance</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="nf">isAppActive</span><span class="p">()</span>
</code></pre>
<p>The AppInstance will post a Notification to the notification center to alert other listeners to the fact that the AppInstance is ready to go. Classes or Controllers that exist at startup and want to make requests using the AppInstance need to wait until it is ready. You can subscribe for the following notification if you want your class to be notfied when the TCSAppInstance is ready. Note this is only a consideration when the app loads new, not when it wakes from the background. <code>APPINSTANCE_ACTIVE</code></p>

<blockquote>
<p>Register for the Nofitication <code>APPINSTANCE_ACTIVE</code> if required</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kt">NSNotificationCenter</span><span class="o">.</span><span class="nf">defaultCenter</span><span class="p">()</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> 
    <span class="nv">selector</span><span class="p">:</span> <span class="kd">#selector(</span><span class="nf">&lt;your-selector&gt;</span><span class="kd">)</span><span class="p">,</span> 
    <span class="nv">name</span><span class="p">:</span> <span class="s">"APPINSTANCE_ACTIVE"</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
<p>Also you can now make other calls to the platform, since the SDK is now initialised with a valid appInstance. If this is a new install, a new AppInstance will be created on the Platform. If this is an existing install (app restarted) or a reinstall then the existing appInstance will be used.</p>

<p>After connection with the platform and also everytime the wakes from the background the SDK will sync to the latest notify action definitions, menu definitions, geolocations, and beacons. It will also begin generating events automatically for various interactions - see Sending Events.</p>
<h1 id='events-and-actions'>Events and Actions</h1>
<p>The SDK will start sending events once it is running, such as when the app is opened, when the device enters or exits a geofence, enters/exits or dwells in proximity of a beacon, scans an image target. Custom events can also be sent from your app.</p>

<p>Events that go to the platform can have actiontriggers attached which conditionally trigger actions based on some criteria. Actions are behaviours for the app to perform and are returned as a response to a submitted event.</p>

<p>To receive actions and act on them you need to set up an appActionDelegate. This should be a class or controller that persists throughout the application. Perhaps a singleton class or base ViewController.</p>

<blockquote>
<p>Set up an AppActionDelegate</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kt">TCSAppInstance</span><span class="o">.</span><span class="nf">sharedInstance</span><span class="p">()</span><span class="o">.</span><span class="n">appActionDelegate</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">your</span> <span class="n">delegate</span><span class="o">&gt;</span> <span class="p">(</span><span class="kt">AppActionDelegate</span><span class="p">)</span>
</code></pre>
<p>The AppActionDelegate should implement <code>didReceiveAppAction</code>. Actions will be returned by the platform as a response to events sent by the sdk. The actions are configured on the platform to have various types and notification behaviours.</p>

<p>An Action has an Action type and a Notification type. The Action Type defines the behaviour when enacted on the device, where as the Notification type defines how or if the user is Notified about its arrival.</p>

<p>The Action Types are as follows</p>

<ul>
<li>  Notification Message - A simple message Notification with Title and Message. It is presented to the user accoring to the Notification Behaviour</li>
<li>  App Page - Notification Message that can redirect to another page in the app based on the Notification Type of the action. </li>
<li>  Webview with URL - Notification Message that can redirect to a webview and open a web page in the app based on the Notification Type of the action.</li>
<li>  Webview with Content - Notification Message with some content that may be opened in a webview or may provide some custom input data.</li>
</ul>

<p>The Notification Types of Actions are as follows</p>

<ul>
<li>  Notification with alert - actively presents an alert in the foreground or background to the user to alert them immediately and give an opportunity to confirm the action (for high priority actions). This performs the action on confirmation.</li>
<li>  Slient Notification - accumulates the action silently. Can be made available to the user in a notification list when the user next uses the app (for lower priority actions). This performs the action if the user chooses to open the notification in the feed.</li>
<li>  No Notification - immediately forwards the action to the app without notifying the user first. Only used in certain senarios where this is desireable. This performs the action immediately when it arrives.</li>
</ul>

<p>A typical flow from an event to an action would be as follows. A user enters a GeoFence and the SDK sends a Geofence entry event to the platform. There are one or more ActionTriggers set up for the entry event for that geofence on the platform. Depending on the filter settings on the action triggers, one or more actions may be triggered and returned to the app. Depending on the type of action and the configuration of the action, the sdk and your app will enact the action.</p>

<blockquote>
<p>Implement <code>didReceiveAppAction</code> in your AppActionDelegate</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="c1">// Example of response to actions forwarded by the SDK</span>
<span class="o">-</span><span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="nv">didReceiveAppAction</span><span class="p">:(</span><span class="kt">TCSAppAction</span> <span class="o">*</span><span class="p">)</span><span class="n">action</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">appActionLock</span> <span class="n">lock</span><span class="p">];</span> <span class="c1">// NSLock to keep from processing two actions simultaneously.</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">actionType</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="kt">ATYPE_APPAGE</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="kt">NSString</span><span class="o">*</span> <span class="n">appPage</span> <span class="o">=</span> <span class="p">[</span><span class="n">action</span> <span class="nv">getParamValueForKey</span><span class="p">:</span><span class="s">@"AppPage"</span><span class="p">];</span>
            <span class="k">if</span><span class="p">([</span><span class="n">appPage</span> <span class="nv">isEqualToString</span><span class="p">:</span><span class="s">@"HOME"</span><span class="p">])</span> <span class="p">{</span>
                <span class="p">[</span><span class="k">self</span> <span class="nv">goToHome</span><span class="p">:</span><span class="n">action</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">([</span><span class="n">appPage</span> <span class="nv">isEqualToString</span><span class="p">:</span><span class="s">@"MAP"</span><span class="p">])</span> <span class="p">{</span>
                <span class="p">[</span><span class="k">self</span> <span class="nv">goToMap</span><span class="p">:</span><span class="n">action</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">([</span><span class="n">appPage</span> <span class="nv">isEqualToString</span><span class="p">:</span><span class="s">@"PROFILE"</span><span class="p">])</span> <span class="p">{</span>
                <span class="p">[</span><span class="k">self</span> <span class="nv">goToProfile</span><span class="p">:</span><span class="n">action</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">([</span><span class="n">appPage</span> <span class="nv">isEqualToString</span><span class="p">:</span><span class="s">@"SETTINGS"</span><span class="p">])</span> <span class="p">{</span>
                <span class="p">[</span><span class="k">self</span> <span class="nv">goToSettings</span><span class="p">:</span><span class="n">action</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">([</span><span class="n">appPage</span> <span class="nv">isEqualToString</span><span class="p">:</span><span class="s">@"CONTACT"</span><span class="p">]){</span>
                <span class="p">[</span><span class="k">self</span> <span class="n">sendEmail</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">([</span><span class="n">appPage</span> <span class="nv">isEqualToString</span><span class="p">:</span><span class="s">@"IMAGE_RECOGNITION"</span><span class="p">]){</span>
                <span class="p">[</span><span class="k">self</span> <span class="nv">goToAR</span><span class="p">:</span><span class="n">action</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">([</span> <span class="n">appPage</span> <span class="nv">isEqualToString</span><span class="p">:</span><span class="s">@"SWITCH_APP"</span><span class="p">]){</span>
                <span class="p">[</span><span class="k">self</span> <span class="nv">goToFeaturedEvents</span><span class="p">:</span><span class="kt">YES</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">([</span><span class="n">appPage</span> <span class="nv">isEqualToString</span><span class="p">:</span><span class="s">@"EVENT"</span><span class="p">]){</span>
                <span class="p">[</span><span class="k">self</span> <span class="n">goToEvents</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">case</span> <span class="kt">ATYPE_WEBURL</span><span class="p">:</span>
            <span class="kt">NSString</span> <span class="o">*</span><span class="n">url</span> <span class="o">=</span> <span class="p">[</span><span class="n">action</span> <span class="nv">getParamValueForKey</span><span class="p">:</span><span class="s">@"Url"</span><span class="p">];</span>
            <span class="c1">//Launch a webview with the url</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="kt">ATYPE_WEBCONTENT</span><span class="p">:{</span>
            <span class="kt">NSString</span><span class="o">*</span> <span class="n">htmlContent</span> <span class="o">=</span> <span class="p">[</span><span class="n">action</span> <span class="nv">getParamValueForKey</span><span class="p">:</span><span class="s">@"HtmlContent"</span><span class="p">];</span>
            <span class="c1">//Do Something with the content</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">default</span><span class="p">:</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">[</span><span class="n">appActionLock</span> <span class="n">unlock</span><span class="p">];</span>
<span class="p">}</span>
</code></pre><h1 id='api-extension-for-custom-endpoints'>Api Extension for custom endpoints</h1>
<p>Implement the TCSAPIExtender to add API calls that are not part of the Core SDK.</p>

<p>It can be convenient to make a Singlton Class where you add the implementation of the call and response implementation of the API call and then pass the data back to your app using a callback as shown.</p>

<blockquote>
<p>You can create an Api Extender as follows by using TCSApiExtender interface in both IOS and Android</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">class</span> <span class="kt">ExtenderAPI</span> <span class="p">:</span> <span class="kt">NSObject</span><span class="p">,</span> <span class="kt">TCSAPIExtender</span> <span class="p">{</span>

    <span class="c1">//Set up as Singleton so it can be used anywhere in your code</span>
    <span class="kd">static</span> <span class="k">let</span> <span class="nv">shared</span><span class="p">:</span> <span class="kt">ExtenderAPI</span> <span class="o">=</span> <span class="p">{</span>
       <span class="k">let</span> <span class="nv">instance</span> <span class="o">=</span> <span class="kt">ExtendedAPI</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">instance</span>
    <span class="p">}()</span>

    <span class="c1">//Create labels for the EndPoints</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">ExampleGetEndpoint</span> <span class="o">=</span> <span class="s">"ExampleGetEndpoint"</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">ExamplePostEndpoint</span> <span class="o">=</span> <span class="s">"ExamplePostEndpoint"</span>

    <span class="c1">//Implement this function from the interface to define endpoints</span>
    <span class="kd">func</span> <span class="nf">getTCSAPICallDefinitions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">AnyHashable</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">pathDefinitions</span> <span class="o">=</span> <span class="p">[</span><span class="kt">AnyHashable</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]()</span>
        <span class="k">var</span> <span class="nv">definition</span><span class="p">:</span> <span class="kt">TCSAPICallDefinition</span>

        <span class="k">var</span> <span class="nv">keyExists</span> <span class="o">=</span> <span class="n">pathDefinitions</span><span class="p">[</span><span class="kt">ExampleGetEndpoint</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">nil</span>
        <span class="k">if</span> <span class="o">!</span><span class="n">keyExists</span> <span class="p">{</span>
            <span class="n">definition</span> <span class="o">=</span> <span class="kt">TCSAPICallDefinition</span><span class="p">(</span><span class="nv">versionPath</span><span class="p">:</span> <span class="s">"/api/1"</span><span class="p">,</span> <span class="nv">path</span><span class="p">:</span> <span class="s">"/example/get"</span><span class="p">,</span> <span class="nv">andMethod</span><span class="p">:</span> <span class="kt">GET</span><span class="p">)</span>
            <span class="n">pathDefinitions</span><span class="p">[</span><span class="kt">ExampleGetEndpoint</span><span class="p">]</span> <span class="o">=</span> <span class="n">definition</span>
        <span class="p">}</span>

        <span class="n">keyExists</span> <span class="o">=</span> <span class="n">pathDefinitions</span><span class="p">[</span><span class="kt">ExampleGetEndpoint</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">nil</span>
        <span class="k">if</span> <span class="o">!</span><span class="n">keyExists</span> <span class="p">{</span>
            <span class="n">definition</span> <span class="o">=</span> <span class="kt">TCSAPICallDefinition</span><span class="p">(</span><span class="nv">versionPath</span><span class="p">:</span> <span class="s">"/api/1"</span><span class="p">,</span> <span class="nv">path</span><span class="p">:</span> <span class="s">"/example/post"</span><span class="p">,</span> <span class="nv">andMethod</span><span class="p">:</span> <span class="kt">POST</span><span class="p">)</span>
            <span class="n">pathDefinitions</span><span class="p">[</span><span class="kt">ExampleGetEndpoint</span><span class="p">]</span> <span class="o">=</span> <span class="n">definition</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">pathDefinitions</span>
    <span class="p">}</span>


    <span class="cm">/**
    *   Check the TCSUrlConnection class for DataCallback, ListCallback definitions.
    */</span>
    <span class="kd">func</span> <span class="nf">postExample</span><span class="p">(</span><span class="nv">message</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">callback</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">DataCallback</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//Create RequestArgs object and set values</span>
        <span class="k">let</span> <span class="nv">requestArgs</span> <span class="o">=</span> <span class="kt">TCSRequestArgs</span><span class="p">()</span>
        <span class="n">requestArgs</span><span class="o">.</span><span class="n">requestType</span> <span class="o">=</span> <span class="kt">ExampleGetEndpoint</span>

        <span class="k">var</span> <span class="nv">itemDictionary</span> <span class="o">=</span> <span class="p">[</span><span class="kt">AnyHashable</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]()</span>

        <span class="c1">//Set any POST data structure to a dictionary</span>
        <span class="n">itemDictionary</span><span class="p">[</span><span class="s">"message"</span><span class="p">]</span> <span class="o">=</span> <span class="n">message</span>

        <span class="n">requestArgs</span><span class="o">.</span><span class="n">payload</span> <span class="o">=</span> <span class="n">itemDictionary</span>
        <span class="c1">//Supply a callback</span>
        <span class="n">requestArgs</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">httpCode</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>

            <span class="c1">//Process the response</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="o">&amp;&amp;</span> <span class="n">httpCode</span> <span class="o">==</span> <span class="mi">200</span> <span class="p">{</span>
                <span class="k">do</span> <span class="p">{</span>
                    <span class="k">let</span> <span class="nv">itemDictionary</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">JSONSerialization</span><span class="o">.</span><span class="nf">jsonObject</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">data</span><span class="o">!</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="o">.</span><span class="n">mutableContainers</span><span class="p">)</span> <span class="k">as!</span> <span class="p">[</span><span class="kt">AnyHashable</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">]</span>

                    <span class="k">let</span> <span class="nv">template</span> <span class="o">=</span> <span class="n">itemDictionary</span>
                    <span class="nf">callback</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
                <span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">anError</span> <span class="k">as</span> <span class="kt">NSError</span> <span class="p">{</span>
                    <span class="nf">callback</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="n">anError</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nf">callback</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="p">(</span><span class="kt">TCSAPIConnector</span><span class="o">.</span><span class="nf">instance</span><span class="p">()</span> <span class="k">as!</span> <span class="kt">TCSAPIConnector</span><span class="p">)</span><span class="o">.</span><span class="nf">request</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">requestArgs</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getExample</span><span class="p">(</span><span class="nv">callback</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">ListCallback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">requestArgs</span> <span class="o">=</span> <span class="kt">TCSRequestArgs</span><span class="p">()</span>
        <span class="n">requestArgs</span><span class="o">.</span><span class="n">requestType</span> <span class="o">=</span> <span class="kt">ExampleGetEndpoint</span>
        <span class="n">requestArgs</span><span class="o">.</span><span class="n">payload</span> <span class="o">=</span> <span class="p">[</span><span class="kt">AnyHashable</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">]()</span>

        <span class="n">requestArgs</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="p">{</span> <span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">httpCode</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
            <span class="k">var</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span>
            <span class="k">var</span> <span class="nv">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="kt">AnyObject</span><span class="p">]()</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="kc">nil</span> <span class="o">&amp;&amp;</span> <span class="n">httpCode</span> <span class="o">==</span> <span class="mi">200</span> <span class="p">{</span>
                <span class="k">do</span> <span class="p">{</span>
                    <span class="k">let</span> <span class="nv">itemDictionary</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">JSONSerialization</span><span class="o">.</span><span class="nf">jsonObject</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">data</span><span class="o">!</span><span class="p">,</span> <span class="nv">options</span><span class="p">:</span> <span class="o">.</span><span class="n">mutableContainers</span><span class="p">)</span> <span class="k">as!</span> <span class="p">[</span><span class="kt">AnyHashable</span> <span class="p">:</span> <span class="kt">Any</span><span class="p">]</span>
                    <span class="n">rewards</span> <span class="o">=</span> <span class="n">itemDictionary</span><span class="p">[</span><span class="s">"rewards"</span><span class="p">]</span> <span class="k">as!</span> <span class="p">[</span><span class="kt">AnyObject</span><span class="p">]</span> 
                <span class="p">}</span> <span class="k">catch</span> <span class="k">let</span> <span class="nv">anError</span> <span class="k">as</span> <span class="kt">NSError</span> <span class="p">{</span>
                    <span class="n">error</span> <span class="o">=</span> <span class="n">anError</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nf">callback</span><span class="p">(</span><span class="n">rewards</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="p">(</span><span class="kt">TCSAPIConnector</span><span class="o">.</span><span class="nf">instance</span><span class="p">()</span> <span class="k">as!</span> <span class="kt">TCSAPIConnector</span><span class="p">)</span><span class="o">.</span><span class="nf">request</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">requestArgs</span><span class="p">)</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="c1">//Create a class for extending the API</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExtenderAPI</span> <span class="kd">implements</span> <span class="n">TCSAPIExtender</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">ExtenderAPI</span> <span class="n">instance</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">ERROR_REQUEST_FAILED</span> <span class="o">=</span> <span class="s">"Error_Request_Failed"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">GETEXAMPLE</span> <span class="o">=</span> <span class="s">"GetExample"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">POSTEXAMPLE</span> <span class="o">=</span> <span class="s">"PostExample"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ExtenderAPI</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ExtenderAPI</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">TCSAPICallDefinition</span><span class="o">&gt;</span> <span class="nf">getTCSAPICallDefinitions</span><span class="o">()</span> <span class="o">{</span>

        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">TCSAPICallDefinition</span><span class="o">&gt;</span> <span class="n">pathDefinitions</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">TCSAPICallDefinition</span> <span class="n">definition</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(!</span><span class="n">pathDefinitions</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">GETRREVENTS</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">definition</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCSAPICallDefinition</span><span class="o">(</span><span class="s">"/api/1"</span><span class="o">,</span> <span class="s">"/events"</span><span class="o">,</span> <span class="n">TCSAPIConstants</span><span class="o">.</span><span class="na">TCSRequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">);</span>
            <span class="n">pathDefinitions</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">GETRREVENTS</span><span class="o">,</span> <span class="n">definition</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">if</span> <span class="o">(!</span><span class="n">pathDefinitions</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">POSTMISSEDPOINTSREQUEST</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">definition</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCSAPICallDefinition</span><span class="o">(</span><span class="s">"/api/1"</span><span class="o">,</span> <span class="s">"/points/missedpointsrequest"</span><span class="o">,</span> <span class="n">TCSAPIConstants</span><span class="o">.</span><span class="na">TCSRequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">);</span>
            <span class="n">pathDefinitions</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">POSTMISSEDPOINTSREQUEST</span><span class="o">,</span> <span class="n">definition</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">pathDefinitions</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postExample</span><span class="o">(</span><span class="n">String</span> <span class="n">message</span><span class="o">,</span> <span class="kd">final</span> <span class="n">TCSDataReturnedDelegate</span> <span class="n">delegate</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">TCSRequestArgs</span> <span class="n">requestArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCSRequestArgs</span><span class="o">();</span>
        <span class="n">requestArgs</span><span class="o">.</span><span class="na">requestType</span> <span class="o">=</span> <span class="n">ExtenderAPI</span><span class="o">.</span><span class="na">POSTEXAMPLE</span><span class="o">;</span>

        <span class="n">JSONObject</span> <span class="n">values</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">values</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"message"</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="n">requestArgs</span><span class="o">.</span><span class="na">payload</span> <span class="o">=</span> <span class="n">values</span><span class="o">;</span>
        <span class="n">requestArgs</span><span class="o">.</span><span class="na">callback</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCSURLConnectionDelegate</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">TCSURLConnection</span> <span class="n">connection</span><span class="o">,</span> <span class="kt">int</span> <span class="n">responseCode</span><span class="o">,</span> <span class="n">String</span> <span class="n">reply</span><span class="o">,</span> <span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">JSONObject</span> <span class="n">data</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                <span class="n">Error</span> <span class="n">error</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

                <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">try</span> <span class="o">{</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">responseCode</span> <span class="o">==</span> <span class="mi">200</span><span class="o">)</span> <span class="o">{</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">reply</span><span class="o">);</span>
                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                            <span class="n">error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Error</span><span class="o">(</span><span class="n">ERROR_REQUEST_FAILED</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
                        <span class="o">}</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Error</span><span class="o">(</span><span class="n">ERROR_REQUEST_FAILED</span><span class="o">,</span> <span class="n">e1</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">delegate</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">delegate</span><span class="o">.</span><span class="na">done</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">error</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">};</span>

        <span class="c1">//Submit the request using TCSApiConnector</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">TCSAPIConnector</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">requestWithArgs</span><span class="o">(</span><span class="n">requestArgs</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">delegate</span><span class="o">.</span><span class="na">done</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">Error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getExample</span><span class="o">(</span><span class="kd">final</span> <span class="n">TCSDataReturnedDelegate</span> <span class="n">delegate</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">TCSRequestArgs</span> <span class="n">requestArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCSRequestArgs</span><span class="o">();</span>
        <span class="n">requestArgs</span><span class="o">.</span><span class="na">requestType</span> <span class="o">=</span> <span class="n">ExtenderAPI</span><span class="o">.</span><span class="na">GETEXAMPLE</span><span class="o">;</span>
        <span class="n">requestArgs</span><span class="o">.</span><span class="na">callback</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TCSURLConnectionDelegate</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">TCSURLConnection</span> <span class="n">connection</span><span class="o">,</span> <span class="kt">int</span> <span class="n">responseCode</span><span class="o">,</span> <span class="n">String</span> <span class="n">reply</span><span class="o">,</span> <span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">JSONObject</span> <span class="n">data</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                <span class="n">Error</span> <span class="n">error</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

                <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">try</span> <span class="o">{</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">reply</span><span class="o">);</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">responseCode</span> <span class="o">==</span> <span class="mi">200</span><span class="o">)</span> <span class="o">{</span>

                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                            <span class="n">error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Error</span><span class="o">(</span><span class="n">ERROR_REQUEST_FAILED</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
                        <span class="o">}</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Error</span><span class="o">(</span><span class="n">ERROR_REQUEST_FAILED</span><span class="o">,</span> <span class="n">e1</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">delegate</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">delegate</span><span class="o">.</span><span class="na">done</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">error</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">};</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">TCSAPIConnector</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">requestWithArgs</span><span class="o">(</span><span class="n">requestArgs</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">delegate</span><span class="o">.</span><span class="na">done</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">Error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">e</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre>
<blockquote>
<p>Add the ApiExtender to TCS</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="c1">// In AppDelegate:</span>
<span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplicationLaunchOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    <span class="c1">//... </span>
    <span class="p">(</span><span class="kt">TCSAPIConnector</span><span class="o">.</span><span class="nf">instance</span><span class="p">()</span> <span class="k">as!</span> <span class="kt">TCSAPIConnector</span><span class="p">)</span><span class="o">.</span><span class="nf">extendsAPI</span><span class="p">(</span><span class="kt">ExtenderAPI</span><span class="o">.</span><span class="n">shared</span><span class="p">)</span>
<span class="p">}</span>
</code></pre><pre class="highlight java tab-java"><code><span class="c1">//Add when initialising TCSAPI AppUrl and ApiKey</span>
<span class="n">TCSAPIConnector</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">extendAPI</span><span class="o">(</span><span class="n">ExtenderAPI</span><span class="o">.</span><span class="na">getInstance</span><span class="o">());</span>
</code></pre>
<blockquote>
<p>Use the APIExtensions in your code</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kt">ExtenderAPI</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">getExample</span><span class="p">(</span><span class="nv">callback</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="o">||</span> <span class="n">list</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">item</span> <span class="k">in</span> <span class="n">list</span><span class="o">!</span> <span class="p">{</span>

    <span class="p">}</span>
<span class="p">})</span>
</code></pre><pre class="highlight java tab-java"><code><span class="n">ExtenderAPI</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getExample</span><span class="o">(</span> <span class="k">new</span> <span class="n">TCSDataReturnedDelegate</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">JSONObject</span> <span class="n">data</span><span class="o">,</span> <span class="n">Error</span> <span class="n">error</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">error</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Do something with data object</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="c1">//Error Handling</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre><h1 id='platform-requests'>Platform Requests</h1>
<p>Requests can be made to the platform to sync various items like calendars, events, exhibitors/speakers, Banner menus for the home screen.</p>
<h1 id='spark-compass-rest-api'>Spark Compass REST Api</h1>
<p>To use the API you will need to request an</p>

<p><em>base domain</em> - base domain to use for API calls
<em>AppUID</em> - A UUID the uniquely defines your app for connection to the platform</p>
<h2 id='headers'>Headers</h2>
<p><strong>X-PF-LocalTime</strong> as an ISO String in local time</p>

<ul>
<li>  2013-09-27T12:40:33Z  (for GMT)</li>
<li>  2013-09-27T12:40:33+08:00</li>
<li>  2013-09-27T12:40:33-04:30</li>
</ul>

<p><strong>X-PF-AppInstanceUID</strong> - a uid that represents the Installation</p>

<p><strong>X-PF-EndUserAccessToken</strong> - User access token generated from successful user login</p>
<h2 id='register-app-instance'>Register App Instance</h2>
<p>When your application first connects to the platform it should Register an App instance, note that your AppUID is required here:</p>
<pre class="highlight plaintext"><code>POST : /api/1/registerAppInstance
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
{
    "appUID" : "bd44093097f946a99cc8a56510847fdf",
    "sdkTarget" : "ANDROID",
    "appVersion" : "0.0.3",
    "osType" : "ANDROID",
    "osVersion" : "4.1",
    "device" : "Samsung Galaxy S3",
    "latitude" : "44.3445",
    "longitude" : "-112.3340"
}

response 201 CREATED
{
    "appInstanceUID": "53b1fb9ae29349ffbff3ff02230d56b0"
}

</code></pre><h2 id='update-appinstance'>Update AppInstance</h2>
<p>If any parameters change for the installation like the app version, the osVersion, an AppInstance update should be sent.</p>
<pre class="highlight plaintext"><code>POST : /api/1/appInstance/update
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
{
    "appVersion" : "0.0.3",
    "osVersion" : "4.1",
    "device" : "Samsung Galaxy S3",
    "latitude" : "44.3445",
    "longitude" : "-112.3340"
}

response 200 OK
</code></pre><h2 id='end-user-registration'>End User Registration.</h2><pre class="highlight plaintext"><code>POST : /api/1/enduser/register
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
{
    "emailAddress" : "BlackBeard@dummy-tcs.com",
    "password" : "bb121"
}
OR
{
    "userName" : "BlackBeard",
    "password" : "bb121"
}
OR
{
    "userName" : "BlackBeard",
    "emailAddress" : "BlackBeard@dummy-tcs.com",
    "password" : "bb121",
    "firstName" : "Black",
    "lastName" : "Beard",
    "attributes" : {
        { "age", "37" },
        { "job", "Pirate" }
    }
}

Any Attributes can be defined for an end user and will be stored in the user profile
Care should be taken to keep attributes consistent between deployment platforms

response 201 CREATED
{
    "endUserAccessToken": "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c973e5c6d8777ff06a86955db6aca5586267f0060cbd7e61cc1ee9bf4f9c90aa3a1ff8a6ef008fefb1af1bb3dd3a10ba6b02416b93d0087c9193817ec472bc41dedc1e1e9314d1c2d28e938bb74c34aa0772a98be179b6377b21624f3141bd85ab1b76",
    "endUser": {
        "status": "ENABLED",
        "emailAddress": "BlackBeard@dummy-tcs.com",
        "emailConfirmationStatus": "CONFIRMED",
        "userName": "BlackBeard",
        "firstName": "Black",
        "lastName": "Beard",
        "creationTime": "2020-04-21T04:41:41.000Z",
        "updateTime": "2020-04-21T04:41:41.000Z",
        "attributes": {},
        "uid": "99d196de5a9f4101be39abca489102dd"
    }
}
</code></pre><h2 id='end-user-login'>End User Login</h2><pre class="highlight plaintext"><code>POST : /api/1/enduser/login
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
{
    "userName" : "BlackBeard",
    "password" : "kb121"
}


response 200 OK
{
    "endUserAccessToken": "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c973e5c6d8777ff06a86955db6aca5586267f0060cbd7e61cc1ee9bf4f9c90aa3a1ff8a6ef008fefb1af1bb3dd3a10ba6b02416b93d0087c9193817ec472bc41dedc1e1e9314d1c2d28e938bb74c34aa0772a98be179b6377b21624f3141bd85ab1b76",
    "endUser": {
        "status": "ENABLED",
        "emailAddress": "BlackBeard@dummy-tcs.com",
        "emailConfirmationStatus": "CONFIRMED",
        "userName": "BlackBeard",
        "firstName": "Black",
        "lastName": "Beard",
        "creationTime": "2020-04-21T04:41:41.000Z",
        "updateTime": "2020-04-21T04:41:41.000Z",
        "attributes": {},
        "uid": "99d196de5a9f4101be39abca489102dd"
    }
}
</code></pre><h2 id='test-end-user-access-token'>Test end user access token</h2><pre class="highlight plaintext"><code>GET : /api/1/testEndUserAccessToken
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..."

response 200 OK
</code></pre><h2 id='end-user-logout'>End User Logout</h2><pre class="highlight plaintext"><code>GET : /api/1/enduser/logout
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..."

response 200 OK
</code></pre><h2 id='get-end-user-profile'>Get End User Profile</h2><pre class="highlight plaintext"><code>GET : /api/1/enduser?cacheVersion=
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..."
cacheVersion : (optional cache version from previous request)

response 200 OK
{
    "cacheStatus": "OUT_OF_SYNC",
    "cacheVersion": "200421044141",
    "endUser": {
        "status": "ENABLED",
        "emailAddress": "BlackBeard@dummy-tcs.com",
        "emailConfirmationStatus": "CONFIRMED",
        "userName": "BlackBeard",
        "firstName": "Black",
        "lastName": "Beard",
        "creationTime": "2020-04-21T04:41:41.000Z",
        "updateTime": "2020-04-21T04:41:41.000Z",
        "attributes": {},
        "uid": "99d196de5a9f4101be39abca489102dd"
    }
}
</code></pre><h2 id='update-end-user-profile'>Update End User Profile</h2><pre class="highlight plaintext"><code>PUT : /api/1/enduser/update
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..."
{
    "userName" : "BlackBeard",
    "firstName" : "Black",
    "lastName" : "Beard",
    "attributes" : {
        { "age", "37" },
        { "job", "Pirate" }
    }
}


response 200 OK
</code></pre><h2 id='update-end-user-profile-image'>Update End User Profile Image</h2><pre class="highlight plaintext"><code>POST : /api/1/enduser/profileImage 
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..."
**Multipart File Request**


response 200 OK
{
    "resourceUid" : "",
    "resourceName" : "",
    "resourceDescription" : "",
    "resourceTaxonomy" : "",
    "resourceStatus" : "",
    "resourceDefinitionId" : "",
    "platform" : "",
    "language" : "",
    "definition" : ""
}
</code></pre><h2 id='forgot-password-request'>Forgot password request</h2><pre class="highlight plaintext"><code>POST : /api/1/enduser/forgotPassword
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
{
    "emailAddress" : "BlackBeard@dummy-tcs.com"
}

response 200 OK

</code></pre><h2 id='change-password'>Change Password</h2><pre class="highlight plaintext"><code>POST : /api/1/enduser/changePassword
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..."
{
    "oldPassword" : "1234",
    "newPassword" : "5678",
}

response 200 OK
{
    endUserAccessToken : &lt;new token&gt;
}

</code></pre><h2 id='change-email'>Change Email</h2><pre class="highlight plaintext"><code>POST : /api/1/enduser/changeEmail
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..."
{
    "password" : "1234",
    "emailAddress" : "BlackBeard@dummy-tcs.com",
}

response 200 OK

</code></pre><h2 id='app-uid-for-code'>App UID for code</h2>
<blockquote>
<p>Get the UID for an app by code</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/app/getUID?appCode=&lt;appCode&gt;
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0

appCode = appCode corresponding to the app to get the UID for

response 200 OK
{
    "appUid": "6c8cc305f55049e68ca5c4064a29f2b2",
    "name": "App Name"
}

</code></pre><h2 id='get-a-menu-by-name'>GET a menu by name</h2>
<p>Menus are lists of named items with associated behaviour described as <strong>actions</strong> which the app should perform when the user taps the menu item within whatever context that item exists.</p>

<p>Menus are created with a title to be requested by the app. e.g. <strong>MainMenu</strong>, <strong>BannerMenu</strong>, <strong>ToolbarMenu</strong>.</p>

<p>Menu Items are then added to each menu</p>

<blockquote>
<p>Get a menu by name</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/menu/{menuID}?cacheVersion
menuID =&gt; name of menu ie. MainMenu
cacheVersion =&gt; cacheVersion of the last menu request response
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0

response 200 OK
{
    "cacheStatus": "OUT_OF_SYNC",
    "cacheVersion": "200421000021",
    "menu": {
        "name": "MainMenu",
        "creationTime": "2020-04-17T03:48:39.000Z",
        "updateTime": "2020-04-21T00:00:21.000Z",
        "menuItems": [ see below ],
        "uid": "0acb366c4d39443887d4e9558326e269"
    }
}
</code></pre><h2 id='menu-item'>Menu Item</h2>
<p>Menu items are created with a behavior called an action.</p>

<p>The following two are the most common ones.
* AppPage - the menu item takes you to another page in the app when you tap on the item 
* Webview with URL - the menu item opens some content in a webpage</p>

<p>A menu item is configured to have a name which may be displayed in the app depending on the context, an icon/image which can be specified by using uploaded content or by specifying a URL. The order of items in a menu can be controlled using the position in menu. </p>

<p>The Icon URL may start with </p>

<ul>
<li>file:// - this means it expects to find the file bundled with the app.</li>
</ul>

<p>Otherwise it will start with </p>

<ul>
<li>https:// </li>
<li><em>IconResourceId</em> means that that the resource is defined as a resource on the platform and should be requested</li>
</ul>

<blockquote>
<p>Menu Item</p>
</blockquote>
<pre class="highlight plaintext"><code>{
    "position": 0,
    "name": "Home",
    "iconUrl": "file://icon_home.png",
    "iconResourceId": 0,
    "creationTime": "2020-04-17T03:48:39.000Z",
    "updateTime": "2020-04-17T03:48:39.000Z",
    "action": { see below },
    "uid": "198904f6c3674732b37bb49f2117be81"
}
</code></pre><h2 id='page-templates'>Page Templates</h2>
<blockquote>
<p>Get the template for the app</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/template
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0

response 200 OK
{
    "uid": "6c8cc305f55049e68ca5c4064a29f2b2",
    "globalValues": {
        "primaryColor": "#ea741e",
        "appLogoUrl": "http://aladdin.sparkcompass.com/content/icons/logo/fitness_logo-mark.png",
        "tertiaryColor": "#0e0e0e",
        "secondaryColor": "#ea741e"
    },
    "pages": {
        "HOME": {
            "uid": null,
            "templateType": "LANDING_TEMPLATE_1",
            "values": {
                "panelLogoUrl": "http://aladdin.sparkcompass.com/content/icons/logo/fitness_logo-white.png",
                "gridItemCornerRadius": "true",
                "panelBgUrl": "http://aladdin.sparkcompass.com/content/icons/header.jpg",
                "gridItemBgOpacity": "0.0",
                "gridItemBgColor": "#000000"
                "gridItems": [ MenuItem - see definition above for menus],
            }
        },
        "REVEAL_MENU": {
            "uid": null,
            "templateType": "REVEAL_MENU",
            "values": {
                "bgColor": "#ffffff",
                "topLogoUrl": "http://aladdin.sparkcompass.com/content/icons/logo/fitness_logo-black.png",
                "menuItems": [ MenuItem - see definition above for menus],
            }
        },
        "OTHER_PAGE" : { // Depending on your app template configuration
            ...
        },
        "ANOTHER_PAGE" : {
            ...
        }
    }
}

</code></pre><h2 id='action'>Action</h2>
<blockquote>
<p>Action</p>
</blockquote>
<pre class="highlight plaintext"><code>{
    "name": "",
    "status": "ENABLED",
    "actionDomain": "MENU",
    "actionType": "APP_PAGE",
    "actionNotificationType": "NONE",
    "creationTime": "2020-04-17T03:48:39.000Z",
    "updateTime": "2020-04-17T03:48:39.000Z",
    "parameters": [
        {
        "name": "AppPage",
        "value": "HOME"
        }
    ],
    "uid": "6dd1288440004a7388adf110d05be7cf"
}
</code></pre><h2 id='actions'>Actions:</h2>
<p>Actions are used throughout the app for telling the app how it should behave as a response to a stimulus from the user - ie go to another page in the app or open a webview or conceptually a number of other things. This is either a direct response programmed to an item in the app or it may be a response to an action returned by the web application to an event sent by the app. For example if geofences are enabled and the user enters a geofence, a geofence entry is sent to the platform. If there is an action returned by the platform as a response then that action depending on its configuration should be performed by the app</p>

<p>The fields of note for an action are </p>

<ul>
<li>Action Type 

<ul>
<li>APP_PAGE - Go to a page in the app</li>
<li>WEBVIEW_WITH_URL - Present a webview with URL</li>
</ul></li>
<li>Parameters

<ul>
<li>Array of name / value pairs that describe the requirements for the Action Type</li>
<li>For ActionType == APP_PAGE parameter is

<ul>
<li>AppPage =&gt; Const descriptor for the page to navigate to eg HOME</li>
</ul></li>
<li>For ActionType == WEBVIEW_WITH_URL

<ul>
<li>Url =&gt; url to display in a webpage</li>
</ul></li>
</ul></li>
</ul>

<p>So create a common place in the app that can process actions.
Any time the user taps on some item that has an action associated with it send that action to your place that processes actions and deal with it there. I usually define some global delegate that exists for the lifetime of the app that can deal with actions.</p>
<h2 id='posting-events'>Posting Events</h2>
<p>Various things happen in the app that should be sent via the API as events.</p>

<p><strong>EventTypes</strong></p>

<ul>
<li>GENERIC</li>
<li>GENERIC_APP</li>
<li>IMAGE_TARGET_RECOGNITION

<ul>
<li>value01 : <em>image target ID</em></li>
</ul></li>
<li>GEOFENCE_ENTRY

<ul>
<li>entityUID : <em>Geofence UID</em></li>
</ul></li>
<li>GEOFENCE_EXIT

<ul>
<li>entityUID : <em>Geofence UID</em></li>
</ul></li>
<li>GEOFENCE_DWELL

<ul>
<li>entityUID : <em>Geofence UID</em></li>
</ul></li>
<li>BEACON_PROXIMITY_ENTRY

<ul>
<li>value01 : <em>Beacon name</em></li>
<li>value02 : <em>Beacon id</em></li>
</ul></li>
<li>BEACON_PROXIMITY_EXIT

<ul>
<li>value01 : <em>Beacon name</em></li>
<li>value02 : <em>Beacon id</em></li>
</ul></li>
<li>BEACON_PROXIMITY_DWELL

<ul>
<li>value01 : <em>Beacon name</em></li>
<li>value02 : <em>Beacon id</em></li>
<li>value03 : <em>Dwell time seconds</em></li>
</ul></li>
<li>BEACON_POP_TOUCH

<ul>
<li>value01 : <em>Beacon name</em></li>
<li>value02 : <em>Beacon id</em></li>
</ul></li>
<li>APP_INSTNACE_AWAKEN</li>
<li>WEBVIEW_LINK</li>
<li>ENDUSER_MENU_INTERACTION

<ul>
<li>entityUID : <em>Menu Item UID</em></li>
</ul></li>
</ul>

<blockquote>
<p>Post an event</p>
</blockquote>
<pre class="highlight plaintext"><code>POST : /api/1/appEvent
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..." (optional)
{
    "eventTime" : "2013-08-13T12:12:33-06:00",
    "eventType" : "APP_INSTANCE_AWAKEN",
    "entityUID" : "c3060d7c507146debf512cb486fe249d" // if the event relates to an entity
    "latitude" : "-36.863445",
    "longitude" : "174.851441",
    "value01" : "supplementary value 1", // optional - see above
    "value02" : "supplementary value 2", // optional - see above
    "value03" : "supplementary value 3", // optional - see above
}

response 200 OK
{
    "actions" : [] // returns actions if the event triggers any.
}

</code></pre><h2 id='get-geolocations'>Get Geolocations</h2><pre class="highlight plaintext"><code>GET : /api/1/geolocations?cacheVersion=
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..." (if logged in)
cacheVersion : (optional cache version from previous request)

response 200 OK
{
    "cacheStatus": "OUT_OF_SYNC",
    "cacheVersion": "200421044141",
    "geoloctions":[ { Geolocation }, ...] 
}

if you keep the list of geoloctions along with the cacheVersion, you can pass the cacheVersion at the next call.
If the definitions on the server have not changed for that cache version then the response will be:
response 200 OK
{
    "cacheStatus": "IN_SYNC",
    "cacheVersion": "200421044141",
    "geoloctions":[] // in this case your local geolocations from last call match the server definitions.
}

</code></pre><h2 id='geolocation'>Geolocation</h2>
<p>Returned in an Array from /api/1/geolocations endpoint.</p>

<p>Geofence Types:</p>

<ul>
<li>CIRCLE - defined by geofenceCenter and geofenceRadius</li>
<li>POLYGON - defined by the array of points in geofencePoints</li>
</ul>

<p>Variables:</p>

<ul>
<li><p>geofencePoints - an Array of points that define the outline of a Polygon fence</p></li>
<li><p>displayLocation - display this geolocation in a mapview with a pin</p></li>
<li><p>displayGeofence - display the fence for this geolocation in a mapview</p></li>
<li><p>iconUrl - the icon to use for a pin in a mapview</p></li>
</ul>

<blockquote>
<p>Geolocation</p>
</blockquote>
<pre class="highlight plaintext"><code>{
    "uid" : "46deb1da7cbf482790aceda3493a1196",
    "status" : "ENABLED",
    "name: "Toms house",
    "alternateDisplayName" : "Home Base",
    "description" : "A geofence around home base",
    "latitude" : -45.0000,
    "longitude" : 174.000,
    "geofenceType" : "CIRCLE", /* or "POLYGON" */
    "geofenceRadius" : 50.0, /* meters */
    "displayLocation" : true, /* or false, */
    "displayGeofence" : true, /* or false, */
    "iconUrl" : "http://url",
    "creationTime" : "2019-09-27T12:40:33Z",
    "updateTime" : "2019-09-27T12:40:33Z",
    "geofencePoints" : [{ GeofencePoint }, ...]
}
</code></pre>
<blockquote>
<p>GeofencePoint</p>
</blockquote>
<h3 id='geofencepoint'>GeofencePoint</h3><pre class="highlight plaintext"><code>{
    "latitude" : &lt;lat&gt;,
    "longitude" : &lt;lon&gt;
}
</code></pre><h1 id='fitness-module-api'>Fitness module API</h1><h2 id='get-workouts'>Get Workouts</h2>
<blockquote>
<p>GET Workouts</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/fitness/workouts
GET : /api/1/fitness/workouts/level/{levelId}
GET : /api/1/fitness/workouts/goal/{goalId}
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0

response 200 OK
[
    { workout },
    ...
]

</code></pre><h2 id='get-exercises'>Get Exercises</h2>
<blockquote>
<p>GET Exercises</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/fitness/exercises
GET : /api/1/fitness/exercises/equipment/{equipmentId}
GET : /api/1/fitness/exercises/zone/{zoneId}
GET : /api/1/fitness/exercises/workout/{workoutId}/day/{day}
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0

response 200 OK
[
    { exercise },
    ...
]

</code></pre><h2 id='get-zones'>Get Zones</h2>
<blockquote>
<p>GET Zones</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/fitness/zones
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0

response 200 OK
[
    { zone },
    ...
]

</code></pre><h2 id='get-goals'>Get Goals</h2>
<blockquote>
<p>GET Goals</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/fitness/goals
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0

response 200 OK
[
    { goal },
    ...
]

</code></pre><h2 id='get-levels'>Get Levels</h2>
<blockquote>
<p>GET Levels</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/fitness/levels
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0

response 200 OK
[
    { level },
    ...
]

</code></pre><h2 id='get-devices'>Get Devices</h2>
<blockquote>
<p>GET Devices</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/fitness/exercises
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
response 200 OK
[
    { Device },
    ...
]
</code></pre><h2 id='get-equipment'>Get Equipment</h2>
<blockquote>
<p>GET Equipment</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/fitness/equipment
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
response 200 OK
[
    { equipment },
    ...
]
</code></pre><h2 id='get-activities'>Get Activities</h2>
<blockquote>
<p>GET Activities</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/fitness/activities
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..."
response 200 OK
[
    { Activity },
    ...
]

</code></pre><h2 id='submit-activity'>Submit Activity</h2>
<blockquote>
<p>POST Activity</p>
</blockquote>
<pre class="highlight plaintext"><code>POST : /api/1/fitness/activity
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
X-PF-EndUserAccesToken : "1860d04f5d7a90072e57ff8f6baa516a8a7273679f396a5e3eba2b4fa3c97..."
{
    "workoutId: : &lt;workoutId&gt;,
    "workoutTime: : "2019-09-27T12:40:33+08:00",
    "duration: : &lt;seconds&gt;,
}

response 201 CREATED
{ activity }

</code></pre><h2 id='get-videos'>Get Videos</h2>
<blockquote>
<p>GET Videos</p>
</blockquote>
<pre class="highlight plaintext"><code>GET : /api/1/fitness/videos
Accept: application/json
Content-Type: application/json
X-PF-LocalTime : 2019-09-27T12:40:33+08:00  
X-PF-AppInstanceUID : 53b1fb9ae29349ffbff3ff02230d56b0
response 200 OK
[
    { video },
    ...
]
</code></pre>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="raw">raw</a>
                <a href="#" data-language-name="swift">swift</a>
                <a href="#" data-language-name="java">java</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
